{"ast":null,"code":"'use strict';\n\nvar _interopRequireDefault = require('@babel/runtime/helpers/interopRequireDefault');\nvar _typeof = require('@babel/runtime/helpers/typeof');\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\nexports['default'] = exports.SeiWalletContext = void 0;\nvar _regenerator = _interopRequireDefault(require('@babel/runtime/regenerator'));\nvar _asyncToGenerator2 = _interopRequireDefault(require('@babel/runtime/helpers/asyncToGenerator'));\nvar _slicedToArray2 = _interopRequireDefault(require('@babel/runtime/helpers/slicedToArray'));\nvar _react = _interopRequireWildcard(require('react'));\nvar _components = require('../components');\nvar _helpers = require('./helpers');\nfunction _getRequireWildcardCache(nodeInterop) {\n  if (typeof WeakMap !== 'function') return null;\n  var cacheBabelInterop = new WeakMap();\n  var cacheNodeInterop = new WeakMap();\n  return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) {\n    return nodeInterop ? cacheNodeInterop : cacheBabelInterop;\n  })(nodeInterop);\n}\nfunction _interopRequireWildcard(obj, nodeInterop) {\n  if (!nodeInterop && obj && obj.__esModule) {\n    return obj;\n  }\n  if (obj === null || _typeof(obj) !== 'object' && typeof obj !== 'function') {\n    return {\n      default: obj\n    };\n  }\n  var cache = _getRequireWildcardCache(nodeInterop);\n  if (cache && cache.has(obj)) {\n    return cache.get(obj);\n  }\n  var newObj = {};\n  var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;\n  for (var key in obj) {\n    if (key !== 'default' && Object.prototype.hasOwnProperty.call(obj, key)) {\n      var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;\n      if (desc && (desc.get || desc.set)) {\n        Object.defineProperty(newObj, key, desc);\n      } else {\n        newObj[key] = obj[key];\n      }\n    }\n  }\n  newObj['default'] = obj;\n  if (cache) {\n    cache.set(obj, newObj);\n  }\n  return newObj;\n}\nvar SeiWalletContext = /*#__PURE__*/(0, _react.createContext)({\n  chainId: '',\n  restUrl: '',\n  rpcUrl: '',\n  accounts: [],\n  connect: function connect() {\n    return undefined;\n  },\n  disconnect: function disconnect() {\n    return undefined;\n  },\n  setConnectionError: function setConnectionError() {\n    return undefined;\n  },\n  setTargetWallet: function setTargetWallet() {\n    return undefined;\n  },\n  setShowConnectModal: function setShowConnectModal() {\n    return undefined;\n  },\n  wallets: []\n});\nexports.SeiWalletContext = SeiWalletContext;\nvar SeiWalletProvider = function SeiWalletProvider(_ref) {\n  var children = _ref.children,\n    chainConfiguration = _ref.chainConfiguration,\n    wallets = _ref.wallets,\n    autoConnect = _ref.autoConnect;\n  var autoConnectSeiWallet = typeof autoConnect === 'string' ? (0, _helpers.findWalletByWindowKey)(autoConnect) : autoConnect;\n  var _useState = (0, _react.useState)(autoConnectSeiWallet),\n    _useState2 = (0, _slicedToArray2['default'])(_useState, 2),\n    targetWallet = _useState2[0],\n    setTargetWallet = _useState2[1];\n  var _useState3 = (0, _react.useState)(),\n    _useState4 = (0, _slicedToArray2['default'])(_useState3, 2),\n    offlineSigner = _useState4[0],\n    setOfflineSigner = _useState4[1];\n  var _useState5 = (0, _react.useState)(),\n    _useState6 = (0, _slicedToArray2['default'])(_useState5, 2),\n    connectionError = _useState6[0],\n    setConnectionError = _useState6[1];\n  var _useState7 = (0, _react.useState)([]),\n    _useState8 = (0, _slicedToArray2['default'])(_useState7, 2),\n    accounts = _useState8[0],\n    setAccounts = _useState8[1];\n  var _useState9 = (0, _react.useState)(false),\n    _useState10 = (0, _slicedToArray2['default'])(_useState9, 2),\n    showConnectModal = _useState10[0],\n    setShowConnectModal = _useState10[1];\n  var _useState11 = (0, _react.useState)(),\n    _useState12 = (0, _slicedToArray2['default'])(_useState11, 2),\n    connectedWallet = _useState12[0],\n    setConnectedWallet = _useState12[1];\n  var filteredWallets = wallets.reduce(function (acc, wallet) {\n    var seiWallet = typeof wallet === 'string' ? (0, _helpers.findWalletByWindowKey)(wallet) : wallet;\n    if (seiWallet !== undefined) acc.push(seiWallet);\n    return acc;\n  }, []);\n  var disconnect = function disconnect() {\n    setTargetWallet(undefined);\n    setOfflineSigner(undefined);\n    setAccounts([]);\n    setConnectedWallet(undefined);\n  };\n  var connectToChain = /*#__PURE__*/function () {\n    var _ref2 = (0, _asyncToGenerator2['default'])( /*#__PURE__*/_regenerator['default'].mark(function _callee() {\n      var enableResponse, fetchedOfflineSigner, fetchedAccounts;\n      return _regenerator['default'].wrap(function _callee$(_context) {\n        while (1) switch (_context.prev = _context.next) {\n          case 0:\n            if (targetWallet) {\n              _context.next = 2;\n              break;\n            }\n            return _context.abrupt('return');\n          case 2:\n            _context.prev = 2;\n            if (window[targetWallet.walletInfo.windowKey]) {\n              _context.next = 6;\n              break;\n            }\n            setConnectionError(targetWallet.walletInfo.windowKey);\n            return _context.abrupt('return');\n          case 6:\n            _context.next = 8;\n            return targetWallet.connect(chainConfiguration.chainId);\n          case 8:\n            enableResponse = _context.sent;\n            _context.next = 11;\n            return targetWallet.getOfflineSigner(chainConfiguration.chainId);\n          case 11:\n            fetchedOfflineSigner = _context.sent;\n            if (fetchedOfflineSigner) {\n              _context.next = 16;\n              break;\n            }\n            setConnectionError(targetWallet.walletInfo.windowKey);\n            disconnect();\n            return _context.abrupt('return');\n          case 16:\n            _context.next = 18;\n            return targetWallet.getAccounts(chainConfiguration.chainId);\n          case 18:\n            fetchedAccounts = _context.sent;\n            if (!(fetchedAccounts.length === 0)) {\n              _context.next = 25;\n              break;\n            }\n            setConnectionError(targetWallet.walletInfo.windowKey);\n            disconnect();\n            return _context.abrupt('return');\n          case 25:\n            setShowConnectModal(false);\n            setOfflineSigner(fetchedOfflineSigner);\n            setAccounts(fetchedAccounts);\n            setConnectedWallet(targetWallet);\n          case 29:\n            _context.next = 36;\n            break;\n          case 31:\n            _context.prev = 31;\n            _context.t0 = _context['catch'](2);\n            console.error('Error connecting to wallet', _context.t0);\n            setConnectionError(targetWallet.walletInfo.windowKey);\n            return _context.abrupt('return');\n          case 36:\n          case 'end':\n            return _context.stop();\n        }\n      }, _callee, null, [[2, 31]]);\n    }));\n    return function connectToChain() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n  (0, _react.useEffect)(function () {\n    if (targetWallet) {\n      connectToChain().then();\n    } else {\n      setOfflineSigner(undefined);\n      setAccounts([]);\n      setConnectedWallet(undefined);\n    }\n  }, [targetWallet, chainConfiguration.chainId]);\n  var contextValue = {\n    chainId: chainConfiguration.chainId,\n    restUrl: chainConfiguration.restUrl,\n    rpcUrl: chainConfiguration.rpcUrl,\n    wallets: filteredWallets,\n    connect: setTargetWallet,\n    disconnect: disconnect,\n    accounts: accounts,\n    offlineSigner: offlineSigner,\n    connectedWallet: connectedWallet,\n    targetWallet: targetWallet,\n    setTargetWallet: setTargetWallet,\n    showConnectModal: showConnectModal,\n    setShowConnectModal: setShowConnectModal,\n    connectionError: connectionError,\n    setConnectionError: setConnectionError\n  };\n  return /*#__PURE__*/_react['default'].createElement(SeiWalletContext.Provider, {\n    value: contextValue\n  }, children, /*#__PURE__*/_react['default'].createElement(_components.WalletSelectModal, {\n    wallets: filteredWallets\n  }));\n};\nvar _default = SeiWalletProvider;\nexports['default'] = _default;","map":null,"metadata":{},"sourceType":"script"}